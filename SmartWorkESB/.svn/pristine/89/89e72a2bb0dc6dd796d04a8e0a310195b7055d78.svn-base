
--任务计划
--每天0:30:00开始归档
DELETE FROM T_IF_TIMER WHERE IF_CODE='ARCHIVE_LOG';
INSERT INTO T_IF_TIMER(JOB_CODE, JOB_DESC, IF_CODE, JOB_GROUP, JOB_CLASS, TRIGGER_NAME, TRIGGER_VALUE, UPDATE_STATE, RUN_STATE)
          SELECT 'ARCHIVE_LOG', '日志归档', 'ARCHIVE_LOG', 'ARCHIVE_LOG', 'com.smartwork.esb.job.TimerJob', 'ARCHIVE_LOG', '0 30 0 * * ?', 1, 1 FROM DUAL
;

--接口
DELETE FROM T_IF_CONFIG WHERE IF_CODE='ARCHIVE_LOG';
INSERT INTO T_IF_CONFIG(IF_CODE, IF_NAME, TO_SYS_NAME, IF_TYPE, SERVICE_TYPE, SERVICE_CLASS, DB_PROC)
          SELECT 'ARCHIVE_LOG', '日志归档', 'ESB', 3, 'Other', 'com.smartwork.esb.transaction.archive.ArchiveLogTimerService', 'PKG_ARCHIVE.USP_ARCHIVE' FROM DUAL;
;

--接口参数
DELETE FROM T_IF_PARAM WHERE IF_CODE = 'ARCHIVE_LOG';
INSERT INTO T_IF_PARAM(PK_ID, IF_CODE, TO_SYS_NAME, PARAM_GROUP, PARAM_CODE, PARAM_NAME, PARAM_VALUE, PARAM_DESC, EDIT_ABLE)
       SELECT 599, 'ARCHIVE_LOG', 'ESB',   'Other',     'LOG_ARCHIVE_DAY',     '日志保留天数',       '30',  '至少1天', 1 FROM DUAL
;
COMMIT;