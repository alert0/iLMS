
--任务计划
--每天1:10:00开始归档
DELETE FROM T_IF_TIMER WHERE IF_CODE='ARCHIVE_LOGFILE';
INSERT INTO T_IF_TIMER(JOB_CODE, JOB_DESC, IF_CODE, JOB_GROUP, JOB_CLASS, TRIGGER_NAME, TRIGGER_VALUE, UPDATE_STATE, RUN_STATE)
          SELECT 'ARCHIVE_LOGFILE', '日志文件归档', 'ARCHIVE_LOGFILE', 'ARCHIVE_LOGFILE', 'com.smartwork.esb.job.TimerJob', 'ARCHIVE_LOGFILE', '0 10 1 * * ?', 1, 1 
;

--接口
DELETE FROM T_IF_CONFIG WHERE IF_CODE='ARCHIVE_LOGFILE';
INSERT INTO T_IF_CONFIG(IF_CODE, IF_NAME, TO_SYS_NAME, IF_TYPE, SERVICE_TYPE, SERVICE_CLASS, DB_PROC)
          SELECT 'ARCHIVE_LOGFILE', '日志文件归档', 'ESB', 3, 'Other', 'com.smartwork.esb.transaction.archive.ArchiveLogFileTimerService', '' ;
;

--接口参数
DELETE FROM T_IF_PARAM WHERE IF_CODE = 'ARCHIVE_LOGFILE';
INSERT INTO T_IF_PARAM(PK_ID, IF_CODE, TO_SYS_NAME, PARAM_GROUP, PARAM_CODE, PARAM_NAME, PARAM_VALUE, PARAM_DESC, EDIT_ABLE)
          SELECT 500, 'ARCHIVE_LOGFILE', 'ESB',   'Other',     'FILE_EVERY_COUNT',    '一次归档文件数',     '500', '范围从100到1000', 1 
UNION ALL SELECT 501, 'ARCHIVE_LOGFILE', 'ESB',   'Other',     'FILE_ARCHIVE_DAY',    '日志文件保留天数',    '30',  '至少1天', 1 
;
COMMIT;